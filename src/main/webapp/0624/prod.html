<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<link rel="stylesheet" href="../css/outStyle.css">
<link rel="stylesheet"
	href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css"
>
<script src="../js/jquery-3.6.0.min.js"></script>
<script
	src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"
></script>
</head>
<body>
	<div class="col-md-3">
		<select class="form-control" id="lprod">
			<!--       <option>lprod리스트</option> -->
		</select>
	</div>
	<div class="col-md-3">
		<select class="form-control" id="prod">
			<option>prod리스트</option>
			<option>prod리스트</option>
			<option>prod리스트</option>
			<option>prod리스트</option>
		</select>
	</div>
	<br>
	<br>
	<div>prod의 상세정보</div>

	<script>

// 제이쿼리로 ajax - lprod 
/* $.ajax({
	url: 'lprod.jsp',	//json obj arr
// 	type:get,
	success:function(data){
	  //select id영역에 뿌려주기..
	  let rst = "";
	  $.each(data,function(i){
		rst += `<option value='${data[i].gu}'>${data[i].nm}</option>`;
	  });
	  $('#lprod').append(rst);	
	},
	error:function(xhr){
		alert(xhr.status);
	},
	dataType: 'json'
}); */

//자바스크립트로 ajax - lprod
//숙제


		let req = new XMLHttpRequest();
		//자바스크립트 형식으로 ajax  - type HTML
		req.open('get', 'lprod.jsp');
		req.send();
		//select id영역에 뿌려주기..
		req.onreadystatechange=function(){
			if (this.readyState == 4 && this.status == 200) {
				let data = JSON.parse(this.responseText);
				let rst = "";
				for (let i = 0; i < data.length; i++) {
					rst += `<option value='${data[i].gu}'>${data[i].nm}</option>`;
				}
				document.querySelector('#lprod').innerHTML = rst;
			}
		}
		// 제이쿼리로 ajax - prod
		$('#lprod').on('change', function() {

			//console.log( $(this).val() ); //요청정보
			$.ajax({
				url : 'prod.jsp',
				data : {
					'gu' : $(this).val()
				},
				success : function() {
				},
				error : function(xhr) {
					alert(xhr.status);
				},
				dataType : 'json'
			});

		});
	</script>
</body>
</html>